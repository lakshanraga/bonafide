-- Policy for `SELECT` (for `authenticated` role)
-- Name: Enable read access for authenticated users based on role
-- Target roles: authenticated
-- USING expression:
(EXISTS (SELECT 1 FROM profiles WHERE id = auth.uid() AND role = 'student' AND batch_id = batches.id)) -- Student can see their own batch
OR
(tutor_id = auth.uid()) -- Tutor can see their assigned batch
OR
(EXISTS (SELECT 1 FROM profiles WHERE id = auth.uid() AND role = 'hod') AND department_id = (SELECT department_id FROM profiles WHERE id = auth.uid())) -- HOD can see batches in their department
OR
(auth.role() = 'admin') -- Admin can see all batches
OR
(auth.role() = 'principal') -- Principal can see all batches